---
import { getCollection } from "astro:content";
import { sortById } from "../../utils/sortById";
import { SITE_TITLE, SITE_DESCRIPTION } from "../../constants";
import Head from "../../components/Head.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import "../../styles/global.css";
import "../../styles/destination.css"

export async function getStaticPaths() {
    const allDestinations = await getCollection("destinations");
    const numberOfDestinations = allDestinations.length;

    return allDestinations.sort(sortById).map((destination, i) => ({
        params: {
            slug: destination.slug,
        },
        props: {
            destination,
            previousDestination: i === 0 ? allDestinations[numberOfDestinations - 1] : allDestinations[i - 1],
            nextDestination: i === numberOfDestinations - 1 ? allDestinations[0] : allDestinations[i + 1],
        },
    }));
}

const { destination, previousDestination, nextDestination } = Astro.props;
---

<html lang="en">
    <Head siteTitle={SITE_TITLE} siteDescription={SITE_DESCRIPTION} pageTitle={destination.data.title} />
    <body>
        <Header />
        <main>
            <div class="container"></div>
            <div class="container case-study mb-5">
                <h1 class="mt-5 mb-3">{destination.data.title}</h1>
                <p>{destination.data.description}</p>
                <ul class="ps-0">
                    <li>
                        {destination.data.imagesUrl.map(imageUrl => <img src={imageUrl} alt="" class="img-fluid w-100 mb-4"/>)}
                    </li>
                    <div class="row mt-5">
                        <div class="col">
                            <div>Previous</div>
                            <div>
                                <a href={`/destinations/${previousDestination.slug}`}>{previousDestination.data.title}</a>
                            </div>
                        </div>
                        <div class="col">
                            <div>Next</div>
                            <div>
                                <a href={`/destinations/${nextDestination.slug}`}>{nextDestination.data.title}</a>
                            </div>
                        </div>
                    </div>
                </ul>
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
                <Footer />
            </div>
        </main>
    </body>
</html>